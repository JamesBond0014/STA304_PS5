---
title: "Police in Canada compared to Police in the USA"
author: "James Bao"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  bookdown::pdf_document2: null
  pdf_document: default
abstract: |
  | We analyzed police use of lethal force from data sets collected by the Fatal Encounters Project and CBC in order to analyze the severity of police killing within Canada and the United States of America. We found a concerning trend in an annual increase of death of police cases every year, even accounting for the increase in population, and although Canada has less death per million and a slower rate of increase of death per million every year compared to the US. We also found that variables can alter the chances a person would die from gun shot versus other unintentional uses of lethal force, although a majority of victims are killed from gun shot in both countries. These findings can be important to analyzing Canada's police use of force reports and suggest that the Canadian police system are not immune to the faults American policing system is accused of. 
  |
  | **Keywords:** Police, Deadly-force, Canada, USA
toc: FALSE
bibliography: references.bib
nocite: '@*'
link-citations: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=6, fig.height=4, echo = FALSE, message = FALSE, 
                      warning = FALSE)
# install.packages("ggplot2")
library(ggplot2)
# install.packages("viridis")  # Install
library("viridis")           # Load
library(plyr)
library(dplyr)
library(tidyverse)
library(knitr)
library(nnet)
```

```{r loading, echo=FALSE}
usa_data <- data.frame(read.csv("../data/usa_parsed_fatalities.csv"))
usa_data_year <-  data.frame(read.csv("../data/usa_yearly_fatalities.csv"))
can_data <- data.frame(read.csv("../data/canada_parsed_fatalities.csv"))
can_data_year <- data.frame(read.csv("../data/canada_yearly_fatalities.csv"))
```


```{r graphssetup}


usa_total <- nrow(usa_data)
can_total <- nrow(can_data)


#function to rename ith column to desired name
rename_i_col <- function(data, new_name, i=1){
  names(data)[i] <- new_name 
  return(data)
}

#Function to get the total of a category
average_total <- function(data, var1){
  data %>% 
    count({{var1}}) %>%  #Count occurrences in each category of the var1 
    rename_i_col("category") %>% #rename into generic name
    data.frame()
}

#function to draw a gar chart given parameters in expected format
graph_bar <- function(data, total, xlab="Category", ylab="Total"){
  data %>%
    ggplot(aes(x=category,y=n), fill="") +
    geom_bar(width = 1, stat = "identity", fill="turquoise3") +
    geom_text(aes(label = paste0(round(n/total*100), "%")), 
          color="black",position = position_stack(vjust = 0.5)) +
    coord_flip() +
    xlab(xlab) +
    ylab(ylab)
}


#generate basic table for display
generate_table <- function(data, labels,caption=""){
  data %>% knitr::kable(caption = caption)
}

basic_table <- function(data, var1, caption=""){
  data %>% count({{var1}}) %>% rename(Count=n) %>% 
    generate_table(c(var1, Count), caption = caption)

}

graph_hist <- function(data, var, xlab="Var", ylab="Total"){
  data %>%
    ggplot() +
    geom_histogram(aes({{var}}), fill="blue")
}

```

The (currently incomplete) code generated in this markdown file can be found on [my Github](https://github.com/JamesBond0014/STA304_PS5). 

# Introduction

On May 25 2020, the death of George Floyd became another name on a long list of people who has died at the hands of police. This incident was caught on camera and sparked riots all across the country, as people called for police reform throughout the US. 2 days later, Regis Korchinski-Paquet in Toronto died in a controversial incident after police became involved, and a similar protest sparked within the city of Toronto, with the Toronto City council voting for changes in policing policies (@boisvert_2020). These are just two deaths among the many people of a visible minority who has died within America and Canada, which is just a portion of all the people who die during an encounter with law enforcement within America and Canada, most recently a police shooting resulted in a death of an infant in Canada. These deaths are a few among over 500 deaths in Canada and 18000 in USA over the past 20 years. This paper attempts to analyze and compare the data from both Canada and USA and model a trend in police related deaths in Canada and USA, as well as model how various external variables could effect the police's use of lethal on people. 

Throughout the paper, we analyze the consistent increase of death per million in both Canada and USA, as well as the demographics of police related deaths in each country. We analyzed the statistical significance of our models, the p-values and their implications. Overall, we found a trend of increasing police related death in both the countries, with USA reaching almost 3 people per a million people dying and Canada going close to 1 death per million. Furthermore, we selected 4 explanatory variables and built a logistic regression model to investigate whether age, gender, race and location is a significant indicator on how a victim is killed, however we found no statistical significance overall. We further investigated demographics of each country and identify if any demographics are over represented within our data sets and we identified males and certain minorities have a disproportional representation within our data set. 

In the following sections of this paper, we will discuss the two data sets that was used, how it was collected, and summarize key variables used from these data sets. We will then discuss the models this paper uses and how they were chosen, followed by a summary of the results from our charts and models. Finally we will discuss the significance and implications of our findings and conclude with our weaknesses and future steps. 

# Data

In order to complete our analysis and models, we used two data sets detailing deaths at the hands of police in both Canada and USA. For this, we used data collected by Fatal Encounters for US data and by CBC for Canadian data. We will discuss how both the data set was collected and highlight certain characteristics of both these data sets.

## Data Collection

### USA Data set

[The Fatal Encounters Project](https://fatalencounters.org/) is a publicly funded organization started in 2012 that is recognized as a charity organization in the United States of America. The organization was started by D. Brian Burghart, after he realized that no official federal organization tracks deaths of people at the hands of police. At the time of writing this report, Fatal Encounters has collected 29192 names, locations, situations and more of people who has been killed by the police. The data was collected by D. Brian Burghart along with other paid researchers and volunteers through primarily 3 methods. They obtained information by gathering law enforcement data through the Freedom of Information Act requests and other public record requests, they crowd sourced internet and news paper searches, and finally they cross checked their data with other reputable data sets such as [The Counted](https://www.theguardian.com/us-news/series/counted-us-police-killings) by the Guardian and [the Fatal Force project](https://www.washingtonpost.com/graphics/investigations/police-shootings-database/) by The Washington Post (this project won the Pulitzer Prize in 2016 (@pulitzer)) among many others (@fatal_encounter_review).  The data starts from Jan 1, 2000 and is updated weekly in order to maintain the most update to information possible. 

### Canada Data set

The Canadian [data set](https://newsinteractives.cbc.ca/fatalpoliceencounters/) containing information on police related deaths is collected by the Canadian Broadcasting Corporation (CBC), and according to the website, it is "the first country-wide database of every person who died or was killed during a police intervention (@cbc_fatal_2018)". Similar to the United States of America, Canada does not provide information on police related deaths on a federal government level, and therefore other organizations such as CBC has collected information across the country. The original project began in 2017 and lasted 6 months, concluding with a list of 461 names ranging form 2000 to 2017 (@cbc_fatal_2018), and this data was updated again in 2020 to include a total of 556 people. The team of researchers at CBC collected the information by going through independent investigator reports, coroner reports, court records, news reports and family interviews (@cbc_2019_how). In contrast to Fatal Encounters, this CBC data set only contains incidences where police purposefully used force, and as such incidences such as in-custody deaths, suicide/accident while evading police or accidental deaths were left out. 

### Data Characteristics

As mentioned before, both the data sets used in this paper are collected through research and requests for information from official sources. However, these sources are not official statistics and are likely to not be a full representation of all the data across either countries. Some low profile deaths may have escaped the attention of any public resources and would be very difficult to locate through research. Due to the expense of collecting and processing the large amounts of data, these data sets could contain some mistakes. As stated by the founder of Fatal Encounters, their data set is not comprehensive and are missing data. The purpose of this project was to identify the names and information about the people who has died, rather than for academic research. Similarly, CBC has stated a similar sentiment regarding the comprehensiveness of their data set. However, both of these data sets are commonly used when analyzing statistics regarding police related deaths. 

A noticeable strength of these data sets however is lack of bias. Since these projects are started with the mission objective of finding as many cases of police use of deadly force as possible, it is reasonable to assume that researchers well attempt to find every case possible in order to represent the entire picture. Another notable benefit of these data sets is that they contain information regarding each death where possible providing context to each name in the list. In addition each data set also attaches a photo of the victim where available and possible. 

While both of these data sets are assumed to be unbias and reasonably accurate, they are collect with slightly different purposes in mind. The Fatal Encounters project attempts to collect data on any person who has died after a police officer has been involved, both on and off duty and regardless of intent to use lethal force. The CBC fatal police encounters data set is focused on police use of force, therefore the data collected are specifically cases where the police purposefully exerted force, both lethal and non-lethal on an individual who died as a result of the use of force. In order to compare the two data sets in a meaningful way, we removed all the cases where use of force was not intended from the Fatal Encounters project's data set. As a result our two data sets now contain data that are more similar and the Fatal Encounters data set will not be bloated with extra data. 

### Costs

Collecting data is expensive, and more so in this case as the process is tedious, slow and often depends on third parties to cooperate. A large part of both organizations' collection process involved obtaining public records through various means, which involved filing requests and waiting. It is hard to estimate the cost of collecting a data set of this size as many steps of the process contain variable costs, and the size of both the teams are unknown. However, due to the rarity of strong data sets regarding this topic, it is safe to assume it is an extremely costly process. 

## Data Features and Visualization

The two data sets combine to almost 30000 data points, and share 35 unique variables across both data sets. Between the two data sets, we chose 5 variables: Date of death, Age, Gender, Race, Province/State, Police department involved, and the cause of death. To filter out the unwanted data, we used the "intended use of force field" to remove the names that were not caused by intentional use of force. 

### USA Data from Fatal Encounters

The Fatal Encounters project has collected a total of 29192 names at the time the data set was downloaded, and contains 27 variables. Among these 27 variables, 3 variables are not recommended to analysis (labeled internal use only) and one variable is in progress (labeled developing). 

The variables we represent are as below:


```{r usaractab}
usa_data %>% basic_table(Race, caption = "Count of USA victims by race")
```


```{r usagentab}
usa_data %>% basic_table(Gender, caption="Count of USA victims by gender")
```


```{r usacodtab}
usa_data %>% basic_table(Cause.of.Death, "Count of cause of death in USA")
```

```{r usaagetab}
usa_data$Age %>% summary() %>% as.array() %>% 
  kable(col.names = c("Statistic","Value"), 
        caption="Age summary of USA victims")
```


```{r usastatab}
usa_data %>% count(Prov.State) %>% arrange(desc(n)) %>% head() %>% 
  rename(State = Prov.State, Count = n) %>% 
  generate_table(caption = "Death counts by state")
```


```{r usapdtab}
usa_data %>% count(Police.Department) %>% arrange(desc(n)) %>% head() %>% 
  rename(State = Police.Department, Count = n) %>% 
  generate_table(caption="Death counts by police department")
```

```{r usaracebar, fig.cap="Distribution of the race of Americans who were killed by police"}
usa_data %>% average_total(Race) %>% graph_bar(usa_total, "Race" ,"Total People")
```

```{r usagenbar, fig.cap="Distribution of the gender of Americans who were killed by police"}
usa_data %>% average_total(Gender) %>% graph_bar(usa_total, "Gender" ,"Total People")

```

```{r usacodbar, fig.cap="Distribution of the Cause of death for US "}
usa_data %>% average_total(Cause.of.Death) %>% 
  graph_bar(usa_total, "Cause of Death" ,"Total People")

```

```{r usaagehist, fig.cap="Distribution of the age of Canadians who were killed by police"}
usa_data %>% graph_hist(Age, "Age" ,"Total People")

```

When we were processing the data set from Fatal Encounters, we had to commonalize variable names as well as category types. We decided to use the Canadian data set as our standards and updated variable naming accordingly. Furthermore, inorder to compare our data, we needed the category naming to be consistent as well (ex Arab vs Middle Eastern). 

From Figure \@ref(fig:usaracebar), we can see that approximately 36% of the victims were white, and 25% were black, while 21% of the victims race was unknown. About 95% of the victims were male, and 5% were females, and 0% were transgender or other (Figure \@ref(fig:usagenbar)). The oldest victim was 107 years old, and the youngest was less than 1 years old, with the mean age of victims being 35.5 years old, with over 300 unknown ages (Table 5). The states with the most people killed were California at over 3000 people between 2000 and 2019, with Texas and Florida following behind at over 1000 deaths each. Most police departments had relatively low death counts, with the exception of police departments from major cities such as Los Angelos, Chicago and New York. 91% of the victims died from gunshot. 

## Canada Data from CBC

CBC has collected 526 data points with 27 variables. Listed below are more details regarding the variables that were chosen for this paper.

```{r canracetab}
can_data %>% basic_table(Race,"Count of Canadian victims by race")
```


```{r cangentab}
can_data %>% basic_table(Gender,"Count of Canadian victims by gender")
```

```{r canprovtab}
can_data %>% count(Prov.State) %>% arrange(desc(n)) %>% head() %>% 
  rename(State = Prov.State, Count = n) %>% 
  generate_table("Count of Canadian victims by Province")
```

```{r cancodtab}
can_data %>% basic_table(Cause.of.Death, "Count of cause of death in Canada")
```

```{r canagetab}
can_data$Age %>% summary() %>% as.array() %>% 
  kable(col.names = c("Statistic","Value"), 
        caption="Age summary of Canadian victim")
```

```{r canpdtab}
can_data %>% count(Police.Department) %>% arrange(desc(n)) %>% head() %>% 
  rename(State = Police.Department, Count = n) %>% 
  generate_table("Death counts by police department")
```

```{r canracebar, fig.cap="Distribution of the race of Canadians who were killed by police"}
can_data %>% average_total(Race) %>% graph_bar(can_total, "Race" ,"Total People")
```

```{r cangenbar, fig.cap="Distribution of the gender of Canadians who were killed by police"}
can_data %>% average_total(Gender) %>% graph_bar(can_total, "Gender" ,"Total People")
```
```{r cancodbar, fig.cap="Distribution of the gender of Canadians who were killed by police"}
can_data %>% average_total(Cause.of.Death) %>% 
  graph_bar(can_total, "Cause of Death" ,"Total People")
```

```{r canagehist, fig.cap="Distribution of the age of Canadians who were killed by police"}
can_data %>% graph_hist(Age, "Age" ,"Total People")

```

The CBC data set showed 44% of all victims were white, 24% were unknown, and 16% were indigenous. The average age was 36.5 years old, with the oldest victim being 77 years old and the youngest being 15 years old, and 11 victims had an unknown age. 96% of the victims were male, and 4% were females. Ontario and British Columbia both had over 100 deaths, at 171 and 108 respectively. The Royal Mounted Canadian police is responsible for the most police related deaths in Canada at 168 deaths. 72% of deaths were a result of a gun shot.

# Model

```{r include=FALSE}

can_model_lm <- lm(dpm ~ year, data = can_data_year)
usa_model_lm <- lm(dpm ~ year, data = usa_data_year)
can_model_lr <- readRDS(file = "../model/can_mod.rds")
usa_model_lr <- readRDS(file = "../model/usa_mod.rds")



predict.lm(can_model_lm, data.frame(year = c(2020)))
predict.lm(usa_model_lm, data.frame(year = c(2020)))
```

In this paper, we used 2 models on both our data sets to gather information for analysis. First we used a simple linear regression in order to model and predict death per million in the year 2020 using data from the last 19 years. Our second model is a multivariate logistic regression to model the affect of race, age, state/province and police department on the most likely type of forced used that lead to loss of life. 

## Simple Linear Regression

One of the most basic ways to get information from our data sets is to determine if police across both countries are killing more or less people every year. A simple linear regression is a great way to model the trend of the death per million in each country as each year passes. By building a model to estimate the trend in the death per million for each country, we can determine if the death per million is progressively getting better or worse or the same. The model takes the equation as follows:

Equation 1:
\begin{equation}
\hat{y} = \beta_0 + \beta_1x
\end{equation}

Where $\beta_0$ is the intercept of a linear equation and $\beta_1$ represents the rate of change with respect to the year and $x$ is the year. The $\hat{y}$ is the predictor, and represents an estimate of the death per million given a year. This model was generated by calculating the death per million for each country using information from our data set and the population in each year from the year 2000 gained from each countries online census information (@usa_census, @can_census). To get the death per million for each year, we divided the death total for that year by the population of that year and multiplied the result by a million. By using the death per million statistic, our model would be able to predict the trend and take into account the growing population every year. Since an increase of population would logically cause an increase of police related deaths, this statistic would take the increase of population into account.  

## Logistic Regression

A logistic regression builds a logistic model, and measures the probability of a certain event happening given the values of its independent variable. The logistic regression has a equation for of: 

Equation 2:
\begin{equation}
Pr(Y_i \in \{Gunshot, Other\}) = logit^{-1}(\alpha^{\textrm{age}} + \alpha_{g[i]}^{\textrm{gender}} + \alpha_{p[i]}^{\textrm{province/state}} + \alpha_{r[i]}^{\textrm{race}})
\end{equation}

In this equation, the $Y_i$ represents the probability a individual is likely to be killed by a gunshot vs being killed to other forms of force. $\alpha^{\textrm{age}}$ represents the age of a victim, $\alpha_{g[i]}^{\textrm{gender}}$ represents the gender, $\alpha_{p[i]}^{\textrm{province/state}}$ is the province or the state and $\alpha_{r[i]}^{\textrm{race}}$ is the race. All of these variables are categorical with the exception of age with is numerical. We model the categorical data numerically in the equation by one-hot encoding the variables. In other words, if a variable $V$ which has 3 categories $A$, $B$ and $C$, then the equation would represent the variables as $W_AV_A$, $W_BV_B$ and $W_CV_C$, where $W_n$ is the weight and $V_n$ is either 0 or 1, and $V_A+V_B+V_C=1$. 

# Results

In this section, we will go over the results from our simple linear regression models and binomial logistic regression models in both data sets.

## Model Selection

There were two primary goals this paper attempted to achieve. The first goal was to determine if the overall situation in Canada was as dire as it is in America. A simple linear regression model was chosen as it creates a linear model and can measure the change of death per million with respect to our independent variable, Year. With this model we can estimate the change in death per million from year to year. This model was chosen for its simplicity and ability to model current relationships as well as give an overall trend. 
The second goal was to examine the effects of certain variables on how an individual is treated in terms of fatal force. Since in North America, use of force guidelines are strict and fairly uniform, it was determined to be a reasonable standard to measure all of our results regardless of Country, State/Province and City. Specifically, in Canada and USA, the police follow a shoot to kill policy, therefore every time a gun is fired by the police, there is intent to kill a suspect. All other methods of force are strictly to detain and apprehend a suspect and does not carry the intention to kill. As such, we processed the data in our binomial regression model so that the cause of death are either gunshot, or other. Since a majority of deaths in each data set (72% in Canada, 91% in USA) were gunshots, our model almost always predicts gunshot as the cause of death. However, this model is able to provide some insight to what variables play a stronger role in an individuals cause of death. This may be important in identifying key factors that effect how an individual is treated in a confrontation with the police, since all non gun shot deaths can be assumed to be unintentional. I chose a logistic regression model as I was interested in the chances of an event happening over predicting the event that will happen and a logistic regression provides this information exactly. I chose a binomial predictor as one of the predictor is an overwhelming favorite and the remaining causes of death are spread thinly among the remaining percents. As a result, I chose to do a binomial logistic regression in order to model the effect various variables has on the overall outcome. 

```{r canslr, fig.cap="Linear regression model of death per million by year in Canada"}
can_data_year %>% 
  ggplot(aes(x = year, y=dpm)) + 
  geom_point(color="red") + 
  geom_smooth(method="lm", color="black", se = FALSE) + 
  scale_x_continuous("Years") +
  scale_y_continuous("Deaths per million") +
  theme_classic()
```



```{r usaslr, fig.cap="Linear regression model of death per million by year in USA"}
usa_data_year %>% 
  ggplot(aes(x = year, y=dpm)) + 
  geom_point(color="red") + 
  geom_smooth(method="lm", color="black", se = FALSE) + 
  scale_x_continuous("Years") +
  scale_y_continuous("Deaths per million")+
  theme_classic()

```



# Dicussion
TBA


<!-- Things to talk about : Gun control, self-defense, why i removed reason.  -->

<!-- https://en.wikipedia.org/wiki/Wesley_Lowery#:~:text=Fatal%20Force%20project,-Lowery%20was%20a&text=The%20project%20won%20the%20Pulitzer,of%2Dforce%20statistics%20in%202017. -->
<!-- The project won the Pulitzer Prize for National Reporting in 2016,[17] and the Justice Department announced a pilot program to begin collecting a more comprehensive set of use-of-force statistics in 2017. -->

# Appendix
TBA

# References